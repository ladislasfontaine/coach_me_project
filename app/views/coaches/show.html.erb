<h2>Page Show Coach - <%= @coach.first_name %></h2>

<div>

  <% if @coach.cover.attached? %>
    <%= image_tag @coach.cover, alt: 'Photo de couverture', class: 'cover-image' %>
  <% end %>

  <% if @coach.avatar.attached? %>
    <%= image_tag @coach.avatar, alt: 'Photo de profil', class: 'avatar-image' %>
  <% else %>
    <p>=== Il n'y a pas encore d'avatar lié à ce coach ===</p>
  <% end %>

  <div>
    Informations :
    <div><%= @coach.first_name %> <%= @coach.last_name %></div>
    <div><%= @coach.price %>€ / heure</div>
    <div>
      <% @coach.specialties.each do |specialty| %>
        <div><%= specialty.name %></div>
      <% end %>
    </div>
    <div><%= @coach.phone_number %></div>

    <p>==================</p>

    Adresse :
    <div><%= @coach.address %></div>
    <div><%= @coach.zip_code %></div>
    <div><%= @coach.city.name %></div>

    <p>==================</p>

    <% if user_signed_in? %>
      <h5>Réserver une séance</h5>

      <%= form_tag seances_path, method: "post" do %>
        <div class="form-group form-check">
          <%= label_tag 'Date et Heure' %>
          <%= datetime_field_tag 'start_date' %>
        </div>
        <div class="form-group form-check">
          <%= label_tag 'Durée (min)' %>
          <%= text_field_tag 'duration', "60" %>
        </div>
        <div class="form-group form-check">
          <%= label_tag 'Lieu' %>
          <%= text_field_tag 'place', "à domicile" %>
        </div>
        <%= hidden_field_tag :coach_id , @coach.id %>
        <%= submit_tag "Réserver", class: "btn btn-primary" %>
      <% end %>

      <p>==================</p>
    <% end %>

    Mes séances :
    <div>
      <% if @coach.seances == [] %>
        Pas encore de séances réservées
      <% else %>
        <h5>Séances à venir</h5>
        <% @coach.seances.select{|seance| seance.start_date > Time.now }.each do |seance| %>
          <div>Début : <%= seance.start_date %></div>
          <div>Durée : <%= seance.duration %>min</div>
          <div>Avec : <%= seance.user.first_name %> <%= seance.user.last_name %></div>
          <%= link_to 'Voir', seance_path(seance.id) %>
          <%= link_to 'Supprimer', seance_path(seance.id), method: 'delete', data: {confirm: "C'est ton dernier mot ?"} %>
        <% end %>
        <h5>Séances passées</h5>
        <% @coach.seances.select{|seance| seance.start_date < Time.now }.each do |seance| %>
          <div>Début : <%= seance.start_date %></div>
          <div>Durée : <%= seance.duration %>min</div>
          <div>Avec : <%= seance.user.first_name %> <%= seance.user.last_name %></div>
          <%= link_to 'Voir', seance_path(seance.id) %>
          <%= link_to 'Supprimer', seance_path(seance.id), method: 'delete', data: {confirm: "C'est ton dernier mot ?"} %>
        <% end %>
      <% end %>
    </div>

  </div>

</div>

<p>==================</p>

<%= link_to 'Modifier mes informations', edit_coach_path(params[:id]) %>
<%= link_to 'Retour', coaches_path %>